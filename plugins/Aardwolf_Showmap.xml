<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Thursday, November 09, 2017, 10:49 AM -->
<!-- MuClient version 5.06-pre -->

<!-- Plugin "Aardwolf_Showmap" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Aardwolf_Showmap"
   author="Pwar"
   id="63882d1089f727f5f94c3f41"
   language="Lua"
   purpose="Easily access links to external maps."
   date_written="2017-11-09 10:45:25"
   requires="4.76"
   version="1.0"
   >
<description trim="y">
<![CDATA[

>    showmap
        - display links to all maps for area you are currently in

>    showmap [areaname]
        - display links to all maps for area you specify 

>    showmap list
        - lists of all areas with external map data (short name)
	
>    showmap togglevi
        - enables or disables visually impaired mode (only shows Gaardian maps)

>    showmap version
        - displays the version of the Showmap plugin (also visible in help)
	
>    showmap help
        - shows only this help

]]>
</description>

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Aliases  -->

<aliases>
  <alias
   match="^showmap$"
   script="map_req_gmcp"
   enabled="y"
   sequence="100"
   regexp="y"
  >
  </alias>

  <alias
   match="^showmap (.+)$"
   script="map_req_area"
   enabled="y"
   sequence="100"
   regexp="y"
  >
  </alias>
  
</aliases>

<script>
<![CDATA[
	require "gmcphelper"
	local currentRoom = {} -- here we will store gmcp room and area data we receive
	local helper_show_maps = 0
	local showmap_ver = "1.0.3"

	-- 235 areas have maps indexed, thanks to Winkle for the original zone table structure, I added all of the maps from the Aardwolf Wiki for Areas
	
	local mapExtData = {

		["aardington"] = { emeraldid = "aardington.png", seekerid = "aardington.php", areaname = "Aardington Estate" },			-- A --

		["academy"] = { gaardid = "258", emeraldid = "aylorianacademy.jpg", areaname = "Academy" },

		["adaldar"] = { emeraldid = "battlefieldsofa.gif", map1 = "https://www.dropbox.com/s/rhamcas4ces3ph2/BattlefieldsOfAdaldar.png", areaname = "Battlefields of Adaldar" },

		["afterglow"] = { areaname = "Afterglow" },

		["agroth"] = { gaardid = "144", emeraldid = "marshlandsofagr.gif", map1="http://aardmaps.agilityhoster.com/marshland.php", map2="http://mikeride.chaosnet.org/abelinc/maps/agroth.gif", areaname = "Marshlands of Agroth" },

		["ahner"] = { gaardid = "76", emeraldid="kingdomahner.gif", map1="http://aardmaps.agilityhoster.com/kingdomofahner.php", areaname = "Kingdom of Ahner" },

		["alehouse"] = { gaardid ="329", emeraldid="waywardalehouse.png", areaname = "Wayward Alehouse" },

		["amazon"] = { emeraldid = "amazon.gif", chaosid = "amazonnation.gif", areaname = "Amazon Nation" },

		["amusement"] = { gaardid = "27", emeraldid = "amusementpark.gif", chaosid = "amusementpark.gif", areaname = "Amusement Park" },

		["andarin"] = { gaardid = "300", areaname = "Blighted Tundra of Andarin" },

		["annwn"] = { seekerid = "annwn.php", areaname = "Annwn" },

		["anthrox"] = { gaardid = "125", emeraldid = "anthrox.gif", map1 = "http://www.aardwolf.com/wiki/uploads/Alhenas%20Anthrox.gif", chaosid = "anthrox.gif", areaname = "Anthrox" },

		["arena"] = { emeraldid = "gladiatorsarena.jpg", map1="http://aardmaps.agilityhoster.com/gladiator.php", areaname = "Gladiator's Arena" },

		["arisian"] = { gaardid = "174", emeraldid = "arisianrealm.gif", map1 = "http://aardmaps.agilityhoster.com/arisianrealm.php", areaname = "Arisian Realm" },

		["ascent"] = { gaardid = "289", areaname = "First Ascent" },

		["astral"] = { emeraldid = "astraltravels.gif", map1 = "https://www.dropbox.com/s/9ijbrmt0kms1kl0/astral_travels.GIF?dl=0", areaname = "Astral Travels" },

		["atlantis"] = { gaardid = "74", emeraldid = "atlantis.png", areaname = "Atlantis" },

		["autumn"] = { emeraldid = "eternalautumn.gif", areaname = "Eternal Autumn" },

		["avian"] = { emeraldid = "avianking.gif", areaname = "Avian Kingdom" },

		["aylor"] = { gaardid = "18", emeraldid = "grandcityofaylo.gif", areaname = "Grand City Aylor" },

		["badtrip"] = { seekerid = "badtrip.php", areaname = "Bad Trip" },						-- B --

		["bazaar"] = { gaardid = "261", emeraldid = "onyxbazaar.gif", map1 = "http://mikeride.chaosnet.org/abelinc/maps/onyx.gif", areaname = "Onyx Bazaar" },

		["beer"] = { gaardid = "15", emeraldid = "landoflegend.gif", map1 = "http://aardmaps.agilityhoster.com/LandofBeerGoblins.php", areaname = "Land of Beer Goblins" },

		["believer"] = { gaardid = "313", emeraldid = "pathofthebeliever.png", areaname = "Path of the Believer" },

		["blackrose"] = { emeraldid = "blackrose.gif", chaosid = "blackrose.gif", areaname = "Black Rose" },

		["bliss"] = { gaardid = "124", emeraldid = "weddedbliss.gif", chaosid = "wedded_bliss.gif", map1 = "http://aardmaps.agilityhoster.com/WeddedBliss.php", areaname = "Wedded Bliss" },

		["caldera"] = { emeraldid = "icymauldoon.gif", map1="http://www.touchstoneclan.com/wp-content/uploads/Maps/Seekers/Mauldoon_Seekers.jpg", areaname = "Icy Caldera Mauldoon" },			-- C --

		["callhero"] = { gaardid = "10", emeraldid = "callofheroes.gif", areaname = "Call of Heroes" },

		["camps"] = { gaardid = "8", emeraldid = "tournamentcamp.gif", chaosid = "tournamentcamps.gif", map1 = "http://aardmaps.agilityhoster.com/tournament.php", areaname = "Tournament Camps" },

		["canyon"] = { gaardid = "254", emeraldid = "canyonmemorialh.gif", areaname = "Canyon Memorial Hospital" },

		["caravan"] = { gaardid = "304", areaname = "Gypsy Caravan" },

		["cards"] = { gaardid = "275", emeraldid = "houseofcards.gif", areaname = "House of Cards" },

		["carnivale"] = { gaardid = "40", emeraldid = "oldcarnivale.gif", chaosid = "Olde%20Worlde%20Carivale.jpg", areaname = "Olde Worlde Carnivale" },

		["cataclysm"] = { emeraldid = "cataclysm.gif", chaosid = "cataclysm.gif", areaname = "Cataclysm" },

		["cathedral"] = { gaardid = "100", emeraldid = "oldcathedral.gif", areaname = "Old Cathedral" },

		["cats"] = { gaardid = "279", emeraldid = "sheilascatsanctuary.png", areaname = "Sheila's Cat Sanctuary" },

		["chasm"] = { gaardid = "251", emeraldid = "chasmandthecata.gif", areaname = "Chasm and Catacombs" },

		["chessboard"] = { gaardid = "28", chaosid = "chessboard.gif", emeraldid = "chessboard.gif", areaname = "Chessboard" },

		["childsplay"] = { gaardid = "30", chaosid = "childsplay.gif", emeraldid = "childplays.gif", map1="http://aardmaps.agilityhoster.com/ChildsPlay.php", areaname = "Child's Play" },

		["cineko"] = { gaardid = "350", map1 = "http://mikeride.chaosnet.org/abelinc/maps/Cineko.gif", areaname = "Aerial City of Cineko" },

		["citadel"] = { seekerid = "flyingcitadel.php", emeraldid = "flyingcitadel.gif", chaosid = "flyingcitadel.gif", map1 = "http://aardmaps.agilityhoster.com/FlyingCitadel.php", areaname = "Flying Citadel" },

		["conflict"] = { gaardid = "340", seekerid = "thandeld.php", emeraldid = "thandeldsconflict.png", areaname = "Thandeld's Conflict" },

		["coral"] = { gaardid = "81", emeraldid = "coralkingdom.gif", areaname = "Coral Kingdom" },

		["cougarian"] = { seekerid = "cougarian.php", map1 = "http://mikeride.chaosnet.org/abelinc/maps/cougarian.gif", emeraldid = "cougarianqueend.gif", areaname = "Cougarian Queendom" },

		["cove"] = { seekerid = "kiksaadi.php", emeraldid = "kiksaadicove.png", areaname = "Kiksaadi Cove" },

		["cradle"] = { gaardid = "80", emeraldid = "cradlebrook.gif", areaname = "Cradlebrook" },

		["crynn"] = { emeraldid = "crynnschurch.png", areaname = "Crynn's Church" },

		["damned"] = { chaosid = "hallofthedamned.gif", map1 = "http://aardmaps.agilityhoster.com/HalloftheDamned.php", areaname = "Halls of the Damned" },			-- D --

 		["darklight"] = { gaardid = "109", emeraldid = "darklight.gif", areaname = "Darklight" },

		["darkside"] = { gaardid = "91", chaosid = "dominia.gif", areaname = "Darkside Fractured Lands" },

		["ddoom"] = { gaardid = "168", emeraldid = "desertdoom.gif", chaosid = "desertdoom.gif", map1 = "http://aardmaps.agilityhoster.com/desertdoom.php", areaname = "Desert Doom" },

		["deadlights"] = { chaosid = "dl.gif", emeraldid = "deadlights.gif", map1 = "https://www.dropbox.com/s/yyxgac9qs6u32hc/Deadlights.pdf?dl=0&raw=1", areaname = "Deadlights" },

		["deathtrap"] = { seekerid = "deathtrapdungeon.php", emeraldid = "deathtrap.gif", areaname = "Deathtrap Dungeon" },

		["deneria"] = { gaardid = "273", emeraldid = "realmofdeneria.jpg", map1 = "http://mikeride.chaosnet.org/abelinc/maps/deneria.gif", areaname = "Realm of Deneria" },

		["desert"] = { emeraldid = "desertprison.png", areaname = "Desert Prison" },

		["desolation"] = { gaardid = "166", emeraldid = "mod.gif", chaosid = "mod.gif", areaname = "Mountains of Desolation MoD" },

		["dhalgora"] = { gaardid = "325", emeraldid = "dhalgora.png", areaname = "Dhal'Gora Outlands" },

		["diatz"] = { gaardid = "107", chaosid = "threepillars.gif", map1 = "http://aardmaps.agilityhoster.com/ThreePillarsofDiatz.php", areaname = "Three Pillars Diatz" },	

		["diner"] = { seekerid = "tumari.php", emeraldid = "tumarisdiner.png", areaname = "Tumari's Diner" },

		["dortmund"] = { gaardid = "31", emeraldid = "dortmund.jpg", map1 = "http://aardmaps.agilityhoster.com/dortmund.php", areaname = "Dortmund" },

		["drageran"] = { seekerid = "drageran.php", emeraldid = "drageran.gif", chaosid = "drageran-empire.gif", areaname = "Drageran Empire" },

		["dread"] = { emeraldid = "dreadtower.gif", chaosid = "Dread%20Tower.gif", areaname = "Dread Tower" },

		["dsr"] = { gaardid = "88", emeraldid = "dsr.gif", areaname = "Diamond Soul Revelation" },

		["dundoom"] = { gaardid = "209", emeraldid = "dungeondoom.gif", chaosid = "dungeon_of_doom.gif", areaname = "Dungeon Doom" },

		["dunoir"] = { emeraldid = "shayolghul.gif", chaosid = "shayol-ghul.gif", areaname = "Mount DuNoir" },

		["duskvalley"] = { gaardid = "351", areaname = "Dusk Valley" },

		["dynasty"] = { gaardid = "149", seekerid = "18.php", chaosid = "eighteenthdynasty.gif", emeraldid = "eighteenthdynasty.gif", areaname = "Eighteenth 18th Dynasty" },

		["earthlords"] = { seekerid = "earthlords.php", emeraldid = "earthlords.png", areaname = "Earth Lords" },				-- E --

		["earthplane"] = { gaardid = "98", chaosid= "eplane4.gif", emeraldid = "earthplane4.jpg", map1 = "http://aardmaps.agilityhoster.com/ep4.php", areaname = "Earth Plane 4" },

		["elemental"] = { gaardid = "290", map1 = "http://mikeride.chaosnet.org/abelinc/maps/elementalchaos.gif", areaname = "Elemental Chaos" },

		["empire"] = { emeraldid = "empireofaiighia.gif", areaname = "Empire of Aiighialla" },

		["empyrean"] = { seekerid = "empyrean.php", areaname = "Empyrean Streets of Downfall" },

		["entropy"] = { gaardid = "154", emeraldid = "archipelagoofen.jpg", areaname = "Archipelago Entropy" },

		["fantasy"] = { gaardid = "33", emeraldid = "fantasyfields.gif", areaname = "Fantasy Fields" },				-- F --

		["farm"] = { gaardid = "301", emeraldid = "kimrsfarm.png", areaname = "Kimr's Farm" },

		["fayke"] = { gaardid = "53", emeraldid = "allinafaykeday.jpg", areaname = "All in Fayke Day" },

		["fens"] = { emeraldid = "curseofthemidni.gif", areaname = "Curse Midnight Fens" },

		["fields"] = { emeraldid = "killingfields.gif", chaosid = "killingfields.gif", map1 = "http://aardmaps.agilityhoster.com/KillingFields.php", areaname = "Killing Fields" },

		["firebird"] = { gaardid = "126", emeraldid = "realmofthefirebird.png", areaname = "Realm of the Firebird" },

		["firenation"] = { gaardid = "287", map1 = "http://mikeride.chaosnet.org/abelinc/maps/sacredflame.jpg", areaname = "Realm of the Sacred Flame" },

		["fireswamp"] = { gaardid = "265", emeraldid = "fireswamp.jpg", areaname = "Fire Swamp" },

		["fortress"] = { gaardid = "104", emeraldid = "goblinefortress.gif", map1 = "http://aardmaps.agilityhoster.com/GoblinFortress.php", areaname = "Goblin Fortress" },

		["fractured"] = { gaardid = "73", emeraldid = "fracturedlands.png", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/dominia.gif", areaname = "Fractured Lands" },

		["ft1"] = { gaardid = "136", emeraldid = "faerietales.gif", chaosid = "faerie_tales.gif", areaname = "Faerie Tales" },

		["ftii"] = { gaardid = "153", emeraldid = "faerietales2.gif", chaosid = "faerie_tales_2.gif", map1 = "http://aardmaps.agilityhoster.com/FaerieTales2.php", areaname = "Faerie Tales II FT2" },

		["gallows"] = { gaardid = "11", emeraldid = "gallowshill.gif", areaname = "Gallows Hill" },					-- G --

		["gathering"] = { emeraldid = "gatheringhorde.png", areaname = "Gathering Horde" },

		["gauntlet"] = { gaardid = "36", chaosid = "gauntlet.gif", seekerid = "gauntlet.php", emeraldid="gauntlet.gif", areaname = "Gauntlet" },

		["gilda"] = { gaardid = "148", chaosid = "gilda.gif", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/gilda.gif", areaname = "Gilda and the Dragon" },

		["glamdursil"] = { emeraldid = "glamdursil.png", areaname = "Glamdursil" },

		["glimmerdim"] = { gaardid = "326", emeraldid = "brightseaandglimmerdim.png", map1 = "http://mikeride.chaosnet.org/abelinc/glimmerdim.gif", areaname = "Brightsea Glimmerdim" },

		["gnomalin"] = { gaardid = "259", emeraldid = "cloudcityofgnom.jpg", areaname = "Cloud City of Gnomalin" },

		["goldrush"] = { gaardid = "83", emeraldid = "goldrush.gif", areaname = "Gold Rush" },

		["graveyard"] = { gaardid = "23", chaosid = "graveyrd.jpg", emeraldid = "graveyard.gif", areaname = "Graveyard" },

		["greece"] = { aardid = "75", emeraldid = "ancientgreece.gif", chaosid = "ancient_greece.gif", areaname = "Ancient Greece" },

		["gwillim"] = { emeraldid = "troublewithgwillimberry.png", seekerid = "gwillimberry.php", areaname = "Trouble with Gwillimberry" },

		["hatchling"] = { gaardid = "264", emeraldid = "hatchlingaerie.gif", areaname = "Hatchling Aerie" },				-- H --

		["hawklord"] = { gaardid = "281", areaname = "Realm of the Hawklords" },

		["hedge"] = { gaardid = "330", emeraldid = "hedgehogsparadise.png", areaname = "Hedgehog's" },

		["helegear"] = { seekerid = "helegear.php", map1 = "http://frostblade.net/aardwolf/maps/helegear.gif", map2 = "http://abelinc.me/helegear", areaname = "Helegear Sea" },

		["hell"] = { gaardid = "86", chaosid = "descent.gif", emeraldid="hell.gif", areaname = "Descent to Hell" },

		["hoard"] = { gaardid = "256", emeraldid = "swordbreakersho.gif", areaname = "Swordbreaker's Hoard" },

		["hodgepodge"] = { gaardid = "38", emeraldid = "magicalhodgepod.gif", areaname = "Magical Hodgepodge" },

		["horath"] = { map1 = "https://www.dropbox.com/s/tgt6uyls7sswe5z/Horath.pdf?dl=0&raw=1", areaname = "Broken Halls of Horath" },

		["horizon"] = { seekerid = "horizon.php", areaname = "Nebulous Horizon" },

		["icefall"] = { areaname = "Icefall" },						-- I

		["illoria"] = { gaardid = "113", emeraldid = "tournamentilloria.gif", map1 = "http://aardmaps.agilityhoster.com/tournamentofilloria.php", areaname = "Illoria" },

		["imagi"] = { gaardid = "360", areaname = "Imagi's Nation" },

		["imperial"] = { gaardid = "112", emeraldid = "imperialnation.gif", areaname = "Imperial Nation" },

		["infamy"] = { map1 = "https://www.dropbox.com/s/va7w7dhcmhkrfue/Infamy.pdf?dl=0&raw=1", areaname = "Realm of Infamy" },

		["infest"] = { gaardid = "41", emeraldid = "infestation.gif", map1 = "http://aardmaps.agilityhoster.com/infestation.php", chaosid = "infestation.gif", areaname = "Infestation" },

		["insan"] = { gaardid = "135", emeraldid = "insanitaria.jpg", areaname = "Insanitaria" },

		["jenny"] = { gaardid = "101", emeraldid = "jennystavern.gif", areaname = "Jenny's Tavern" },					-- J --

		["jotun"] = { gaardid = "307", emeraldid = "jotunheim.png", areaname = "Jotunheim" },

		["kearvek"] = { gaardid = "282", areaname = "Keep of Kearvek" },				-- K --

		["kerofk"] = { gaardid = "51", emeraldid = "kerofk.gif", chaosid = "kerofk.gif", areaname = "Kerofk" },

		["ketu"] = { gaardid = "266", emeraldid = "ketuuplands.gif", areaname = "Ketu Uplands" },

		["kingsholm"] = { gaardid = "306", areaname = "Kingsholm" },

		["knossos"] = { seekerid = "knossos.php", emeraldid = "knossos.gif", chaosid = "great_city_of_knossos.gif", areaname = "Great City of Knossos" },

		["kobaloi"] = { gaardid = "327", emeraldid = "keepofthekobaloi.png", areaname = "Keep of the Kobaloi" },

		["kultiras"] = { gaardid = "68", emeraldid = "kultiras.gif", chaosid = "kul_tiras.gif", areaname = "Kul Tiras" },

		["lab"] = { gaardid = "250", emeraldid = "chaprenulaslabo.gif", areaname = "Chaprenula's Laboratory" },			-- L --

		["labyrinth"] = { gaardid = "82", emeraldid = "labyrinth.gif", chaosid = "labyrinth.gif", areaname = "Labyrinth" },

		["lagoon"] = { emeraldid = "blacklagoon.gif", areaname = "Black Lagoon" },

		["landofoz"] = { gaardid = "94", emeraldid = "oz.gif", chaosid = "oz.jpg", areaname = "Land of Oz" },

		["laym"] = { seekerid = "laym.php", emeraldid = "tairhalaym.gif", chaosid = "Tairahlaym.jpg", areaname = "Tai'rha Laym" },

		["legend"] = { gaardid = "13", emeraldid = "landoflegend.gif", map1 = "http://aardmaps.agilityhoster.com/landoflegend.php", areaname = "Land of Legend LoL" },

		["lemdagor"] = { seekerid = "lemdagor.php", map1="http://mikeride.chaosnet.org/abelinc/maps/borg.html", areaname = "Storm Ships of Lem-Dagor" },

		["lidnesh"] = { gaardid = "5", emeraldid = "forestoflidnesh.gif", areaname = "Forest of Li'Dnesh" },

		["livingmine"] = { gaardid = "291", emeraldid = "livingminesofdaktai.png", areaname = "Living Mines of Dak'Tai" },

		["longnight"] = { gaardid = "141", emeraldid = "longnight.gif", chaosid = "itln.gif", areaname = "Into the Long Night" },

		["losttime"] = { gaardid = "127", emeraldid = "islandlosttime.gif", areaname = "Island of Lost Time" },

		["lplanes"] = { map1 = "http://www.touchstoneclan.com/wp-content/uploads/Maps/Light/Lowerplanes_Light.gif", areaname = "Lower Planes" },

		["maelstrom"] = { gaardidd = "288", map1 = "http://mikeride.chaosnet.org/abelinc/maps/maelstrom.gif", areaname = "Maelstrom" },							-- M --				-- M --

		["manor"] = { gaardid = "72", emeraldid = "deathsmanor.gif", chaosid = "deaths_manor.gif", areaname = "Death's Manor" },

		["masq"] = { emeraldid = "masqueradeislan.gif", map1 = "https://www.dropbox.com/s/ggbm569agasou4m/Masq.png", areaname = "Masquerade Island" },

		["mayhem"] = { emeraldid = "artificersmayhe.gif", chaosid = "artificiersmayhem.gif", areaname = "Artificer's Mayhem" },

		["melody"] = { gaardid = "9", emeraldid = "artmelody.gif", chaosid = "melody2.gif", map1 = "http://www.chaos.ee/links/maps/melody2.gif", areaname = "Art of Melody" },

		["minos"] = { gaardid = "255", emeraldid = "shadowsofminos.gif", areaname = "Shadows of Minos" },

		["mistridge"] = { emeraldid = "covmistridge.gif", chaosid = "mistridge.gif", areaname = "Covenant of Mistridge" },

		["monastery"] = { gaardid = "131", emeraldid = "monastery.gif", areaname = "Monastery" },

		["mudwog"] = { gaardid = "328", emeraldid = "mudwogsswamp.png", areaname = "Mudwog's Swamp" },

		["nanjiki"] = { seekerid = "nanjiki.php", emeraldid = "nanjikiruins.gif", chaosid = "nanjiki_ruins.gif", areaname = "Nanjiki Ruins" },					-- N --

		["necro"] = { gaardid = "69", emeraldid = "necromancersgui.gif", areaname = "Necromancer's Guild" },

		["nenukon"] = { emeraldid = "nenukon.png", areaname = "Nenukon and the Far Country" },

		["newthalos"] = { gaardid = "56", emeraldid = "newthalos.gif", chaosid = "newthalos.gif", areaname = "New Thalos" },

		["northstar"] = { gaardid = "121", emeraldid = "northstar.gif", areaname = "Northstar" },

		["nottingham"] = { emeraldid = "nottingham.gif", areaname = "Nottingham" },

		["nulan"] = { gaardid = "278", areaname = "Plains of Nulan'Boar" },

		["nursing"] = { gaardid = "347", emeraldid = "ascensionbluffnursinghome.png", seekerid = "nursing.php", areaname = "Ascension Bluff Nursing Home" },

		["nynewoods"] = { seekerid = "nyne.php", emeraldid = "nynewoods.png", areaname = "Nyne Woods" },

		["oceanpark"] = { map1 = "http://mikeride.chaosnet.org/abelinc/maps/OceanPark.gif", areaname = "Ocean Adventure Park" },		-- O --

		["omentor"] = { gaardid = "322", emeraldid = "witchesofomentor.png", areaname = "Witches of Omen Tor" },

		["origins"] = { seekerid = "tribal.php", areaname = "Tribal Origins" },

		["orlando"] = { gaardid = "12", emeraldid = "hotelorlando.gif", chaosid = "hotelorlando.gif", areaname = "Hotel Orlando" },

		["paradise"] = { seekerid = "paradiselost.php", emeraldid = "paradiselost.gif", chaosid = "paradiselost.gif", areaname = "Paradise Lost" },				-- P --

		["peninsula"] = { gaardid = "331", emeraldid = "tairaydenpeninsula.png", areaname = "Tairayden Peninsula" },

		["petstore"] = { gaardid = "26", emeraldid = "giantspetstore.gif", chaosid = "giantspetstore.gif", areaname = "Giant's Pet Store" },

		["pompeii"] = { gaardid = "129", emeraldid = "pompeii.gif", areaname = "Pompeii" },

		["promises"] = { emeraldid = "foolishpromise.gif", areaname = "Foolish Promises" },

		["prosper"] = { seekerid = "prosperisland.php", map1 = "http://mikeride.chaosnet.org/abelinc/maps/borg.html", areaname = "Prosper's Island" },

		["qong"] = { map1 = "http://aardmaps.agilityhoster.com/qong.php", areaname = "Qong" },								-- Q --

		["quarry"] = { seekerid = "gnollsquarry.php", areaname = "Gnoll's Quarry" },

		["radiance"] = { gaardid = "355", areaname = "Radiance Woods" },

		["raga"] = { gaardid = "90", emeraldid = "raganatittu.gif", areaname = "Raganatittu" },						-- R --

		["raukora"] = { emeraldid = "bloodopal.png", chaosid = "fortress_of_angband.gif", areaname = "Blood Opal of Rauko'ra" },

		["rebellion"] = { emeraldid = "rebellionofthenix.png", areaname = "Rebellion Nix" },

		["remcon"] = { emeraldid = "remanconspiracy.gif", chaosid = "reman_conspiracy.gif", areaname = "Reman Conspiracy" },

		["reme"] = { gaardid = "84", emeraldid = "impcityreme.gif", chaosid = "reme.gif", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/reme.gif", areaname = "City of Reme" },

		["rosewood"] = { gaardid = "111", emeraldid = "rosewoodcastle.png", areaname = "Rosewood Castle" },
		
		["ruins"] = { seekerid = "diamondreach.php", emeraldid = "diamondreach.gif", chaosid = "ruinsofdiamondreach.gif", map1 = "http://aardmaps.agilityhoster.com/ruinsofdiamondreach.php", areaname = "Ruins of Diamond Reach" },

		["sagewood"] = { seekerid = "sagewood.php", emeraldid = "sagewoodgrove.png", map1 = "http://goo.gl/t06Gde", areaname = "Sagewood Grove" },				-- S --

		["sahuagin"] = { seekerid = "sahuagin.php", areaname = "Abyssal Caverns of Sahuagin" },

		["salt"] = { gaardid = "89", emeraldid = "greatsaltflats.gif", areaname = "Great Salt Flats" },

		["sanctity"] = { chaosid = "sanctity_of_eternal_damnation.gif", emeraldid = "sanctitydamnation.gif", map1 = "http://aardmaps.agilityhoster.com/SanctityofEternalDamnation.php", areaname = "Sanctity of Eternal Damnation" },

		["sanctum"] = { seekerid = "sanctum.php", areaname = "Blood Sanctum" },

		["sandcastle"] = { gaardid = "277", areaname = "Sho'aram Shoaram Castle in the Sand" },

		["sanguine"] = { seekerid = "sanguine.php", emeraldid = "sanguinetavern.png", areaname = "Sanguine Tavern" },

		["scarred"] = { seekerid = "scarred.php", emeraldid = "scarredland.gif", chaosid = "scarred_lands.gif", map1 = "http://aardmaps.agilityhoster.com/ScarredLands.php", areaname = "Scarred Lands" },

		["sendhian"] = { gaardid = "316", areaname = "Adventures in Sendhia" },

		["sennarre"] = { gaardid = "14", emeraldid = "sennarrelake.gif", areaname = "Sen'narre Lake" },

		["shouggoth"] = { gaardid = "62", emeraldid = "templeshouggoth.gif", areaname = "Temple of Shouggoth" },

		["siege"] = { seekerid = "koboldsiege.php", areaname = "Kobold Seige Camp KSC" },

		["sirens"] = { gaardid = "21", emeraldid = "sirensoasisreso.jpg", areaname = "Siren's Oasis Resort" },

		["slaughter"] = { gaardid = "151", emeraldid = "slaughterhouse.gif", areaname = "Slaughterhouse" },

		["snuckles"] = { gaardid = "122", emeraldid = "snucklesvillage.gif", areaname = "Snuckles Village" },

		["soh"] = { emeraldid = "schoolhorror.gif", chaosid = "school_of_horror.gif", seekerid = "schoolofhorror.php", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/school-of-horror.gif", map2 = "https://www.dropbox.com/s/ewelwtmmthbb1uf/OuterSpace.png", areaname = "School of Horror SOH1" },

		["sohtwo"] = { emeraldid = "schoolhorror.gif", chaosid = "school_of_horror.gif", seekerid = "schoolofhorror.php", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/school-of-horror.gif", map2 = "https://www.dropbox.com/s/ewelwtmmthbb1uf/OuterSpace.png", areaname = "School of Horror SOH2" },

		["solan"] = { gaardid = "305", areaname = "Town of Solan" },

		["songpalace"] = { gaardid = "319", areaname = "Palace of Song" },

		["spyreknow"] = { gaardid = "283", areaname = "Guardian's Spyre of Knowledge" },

		["stone"] = { seekerid = "fabled.php", emeraldid = "citystone.gif", chaosid = "FabledCityofstonesmap.gif", map1 = "http://aardmaps.agilityhoster.com/FabledCityofStone.php", areaname = "Fabled City of Stone" },

		["storm"] = { gaardid = "57", emeraldid = "stormmountain.gif", chaosid = "storm.gif", areaname = "Storm Mountain" },

		["stormhaven"] = { gaardid = "324", emeraldid = "ruinsofstormhaven.png", areaname = "Ruins of Stormhaven" },

		["stronghold"] = { gaardid = "118", emeraldid = "darkelf.gif", chaosid = "dark-elf-stronghold.gif", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/dark-elf-stronghold.gif", areaname = "Dark Elf Stronghold DES" },

		["stuff"] = { gaardid = "stuffofshadows.gif", areaname = "Stuff of Shadows" },

		["takeda"] = { emeraldid = "takeda.gif", areaname = "Takeda's Warcamp" },				-- T --

		["talsa"] = { gaardid = "119", emeraldid = "empiretalsa.gif", chaosid = "empire_of_talsa.gif", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/talsa.gif", areaname = "Empire of Talsa" },

		["temple"] = { gaardid = "198", emeraldid = "shalindrael.gif", areaname = "Temple of Shal'indrael" },

		["tanra"] = { gaardid = "323", emeraldid = "tanravea.png", areaname = "Tanra'vea" },

		["terra"] = { areaname = "Cracks of Terra" },

		["terramire"] = { gaardid = "55", areaname = "Fort Terramire" },

		["thieves"] = { gaardid = "25", emeraldid = "denofthieves.png", chaosid = "denofthieves.GIF", map1 = "http://aardmaps.agilityhoster.com/denofthieves.php", areaname = "Den of Thieves" },

		["times"] = { gaardid = "280", emeraldid = "intriguesoftimespast.png", areaname = "Intrigues of Times Past" },

		["tirna"] = { emeraldid = "tirnanog.gif", map1 = "http://aardmaps.agilityhoster.com/TirNaNog.php", areaname = "Tir na Nog" },

		["tol"] = { emeraldid = "treelife.gif", areaname = "Tree of Life" },

		["tombs"] = { emeraldid = "relinquishedtombs.png", seekerid = "tombs.php", areaname = "Relinquished Tombs" },

		["umari"] = { gaardid = "293", areaname = "Umari's Castle" },					-- U --

		["underdark"] = { gaardid = "70", emeraldid = "underdark.jpg", chaosid = "underdark.gif", areaname = "Underdark" },

		["uplanes"] = { map1 = "http://www.touchstoneclan.com/wp-content/uploads/Maps/Light/Upperplanes_Light.gif", areaname = "Upper Planes" },

		["uprising"] = { seekerid = "uprising.php", areaname = "Uprising" },

		["vale"] = { gaardid = "253", emeraldid = "sunderedvale.gif", areaname = "Sundered Vale" },						-- V --

		["verdure"] = { emeraldid = "vestate.gif", areaname = "Verdure Estate" },

		["verume"] = { gaardid = "59", emeraldid = "junglesverume.gif", chaosid = "junglesofverume.gif", map1 = "http://aardmaps.agilityhoster.com/JunglesofVerume.php", areaname = "Jungles of Verume" },

		["village"] = { gaardid = "164", emeraldid = "pgv.gif", areaname = "Peaceful Giant Village" },

		["vlad"] = { gaardid = "97", emeraldid = "vladshamir.gif", chaosid = "vlad.jpg", map1 = "http://aardmaps.agilityhoster.com/CastleVlad-Shamir.php", areaname = "Vlad Shamir" },

		["volcano"] = { gaardid = "85", emeraldid = "silvervolcano.gif", map1 = "http://www.geo.ut.ee/~kallu/k5/mud/silver-volcano.gif", areaname = "Silver Volcano" },

		["weather"] = { gaardid = "299", emeraldid = "weatherobservatory.png", map1 = "http://mikeride.chaosnet.org/abelinc/maps/observatory.gif", areaname = "Weather Observatory" },			-- W --

		["werewood"] = { emeraldid = "werewood.gif", chaosid = "werewood.gif", areaname = "Were Wood" },

		["wildwood"] = { gaardid = "317", areaname = "Wildwood" },

		["winter"] = { gaardid = "175", emeraldid = "winterlands.gif", areaname = "Winterlands" },

		["wizards"] = { gaardid = "46", emeraldid = "warwizards.jpg", chaosid = "warofwizards.gif", map1 = "http://aardmaps.agilityhoster.com/warofwizards.php", areaname = "War of the Wizards WoW" },

		["wonders"] = { emeraldid = "sevenwonders.gif", chaosid = "sevenwonders.gif", map1 = "http://aardmaps.agilityhoster.com/SevenWonders.php", areaname = "Seven Wonders" },

		["wooble"] = { gaardid = "92", emeraldid = "woobleville.gif", areaname = "Wobbly Woes of Woobleville" },

		["woodelves"] = { gaardid = "37", emeraldid = "elvesnalondir.gif", areaname = "Wood Elves of Nalondir" },

		["wtc"] = { gaardid = "285", areaname = "Warrior Training Camp WTC" },

		["wyrm"] = { emeraldid = "wyrm.gif", map1 = "http://www.touchstoneclan.com/wp-content/uploads/Maps/Emerald/Wyrm2_Emerald.gif", areaname = "Council of the Wyrm" },

		["xmas"] = { gaardid = "146", emeraldid = "christmas.gif", areaname = "Christmas Vacation" },				-- X --

		["xylmos"] = { seekerid = "xyl.php", map1 = "https://www.dropbox.com/s/fhkzk13spt5f7pk/Xyl.png", areaname = "Xyl's Mosaic" },

		["yarr"] = { gaardid = "147", emeraldid = "mistyshoresofya.gif", areaname = "Misty Shores of Yarr" },				-- Y --

		["ygg"] = { remeraldid = "yggdrasil.gif", chaosid = "yggdrasil.gif", areaname = "Yggdrasil: The World Tree" },

		["yurgach"] = { emeraldid = "yurgach.gif", areaname = "Yurgach Domain" },

		["zangar"] = { emeraldid = "zangarsdemonicg.gif", seekerid = "zangar.php", areaname = "Zangar's Demonic Grotto" },			-- Z --

		["zodiac"] = { gaardid = "257", emeraldid = "realmofthezodia.gif", areaname = "Realm of the Zodiac" },

		["zoo"] = { gaardid = "39", emeraldid = "aardwolfzoologi.gif", areaname = "Aardwolf Zoological Park" },

		["zyian"] = { emeraldid = "darktemplezyian.gif", areaname = "Dark Temple of Zyian" },

	}
	
	function map_req_gmcp(msg, id, name, text)
		Send_GMCP_Packet("request area") 
		helper_show_maps = 1
	end
	
	function map_req_area(name, line, wildcards)
		map_showmap(nil, nil, wildcards)
	end
	
	function OnPluginBroadcast (msg, id, name, text)
		if (id == '3e7dedbe37e44942dd46d264') then		-- GMCP Handler plugin
			if (text == "room.area") then
				res, gmcparg = CallPlugin("3e7dedbe37e44942dd46d264","gmcpval","room.area")
				luastmt = "gmcpdata = " .. gmcparg
				assert (loadstring (luastmt or "")) ()
				currentRoom.areaname = gmcpval("name")
			elseif (text == "room.info") then
                                res, gmcparg = CallPlugin("3e7dedbe37e44942dd46d264","gmcpval","room.info")
                                luastmt = "gmcpdata = " .. gmcparg
                                assert (loadstring (luastmt or "")) ()
                                currentRoom.areaid = gmcpval("zone")
				if (helper_show_maps == 1) then -- we only want to call map_showmap if it was requested
					helper_show_maps = 0
	                        	map_showmap()
				end
			end
		end
	end


        function map_showmap (name, line, wildcards)

		-- These are various web root folders for Gaardian/Emerald/Seeker/Chaos websites.
		-- They are prepended to gaardid, emeraldid, seekerid, and chaosid to create the map urls.

		local gaardroot = "http://maps.gaardian.com/index.php?areaid="
		local gaardviroot = "http://maps.gaardian.com/vi-index.php?areaid="
		local emeraldroot = "http://emeraldknights.tk/pubmaps/"
		local seekerroot = "http://aardseekermaps.mygamesonline.org/"
		local chaosroot = "http://www.chaos.ee/links/maps/"
                local areaid = string.lower(currentRoom.areaid) -- force lowercase just in case
		
		if (wildcards ~= nil) then -- we have an arg
			if (wildcards[1] == "help") then

				print("")
				NoteStyle(2)			        
				ColourNote("MediumSeaGreen", "", "Showmap v" .. showmap_ver .. " for Aardwolf by Pwar")
				NoteStyle(0)
				print("")
				--print("===================================")
				ColourNote("SteelBlue", "", GetPluginInfo (GetPluginID (), 3))
				print("")
				return
			elseif (wildcards[1] == "version") then
				print("")
				ColourNote("SteelBlue", "", "Currently running version: ", "MediumSeaGreen", "", "Showmap v" .. showmap_ver .. " by Pwar")
				print("")
				return
			elseif (wildcards[1] == "ft2") then
				wildcards[1] = "ftii"
			elseif (wildcards[1] == "list") then
				list_areas()
				return
			elseif (wildcards[1] == "togglevi") then
				toggle_vi()
				return
			end
			
			areaid = find_area(wildcards[1])
			if (areaid == nil) then
			  ColourNote("SteelBlue", "", "Unable to find maps for area name matching: ", "Red", "",  wildcards[1])
			  print("")
			  return
			end
		end
               	-- a few sanity checks to make sure we have room info, etc
		if (areaid ~= nil) and (mapExtData[areaid] ~= nil) then
                	
			if (GetVariable("ToggleVI") ~= "1") then
				NoteStyle(2)
				ColourNote("SteelBlue", "", "Displaying known maps for " .. mapExtData[areaid].areaname .. " (", "MediumSeaGreen", "", areaid, "SteelBlue", "", ")")
				NoteStyle(0)
				print("")   
			end
			
			-- This checks if there's a map defined for this area at Gaardian's site

                        if (mapExtData[areaid].gaardid ~= nil) then                       -- Exact match on area id

				ColourTell("MediumSeaGreen", "", padRight("Gaardian" .. " ", 20, " "))
				
				-- If the user is VI provide link to Gaardian VI map only
				if (GetVariable("ToggleVI") == "1") then
					local url = gaardviroot .. mapExtData[areaid].gaardid
					Note("Opening map for " .. mapExtData[areaid].areaname)
					OpenBrowser(url)
					print("") -- this will add a newline
					return -- we return here because we only want to open Gaardian VI results
				end
				local url = gaardroot .. mapExtData[areaid].gaardid
				Hyperlink(url, url, "[Gaardian Map]", "blue", "", true)
				print("") -- this will add a newline
			end	

			-- This checks if there's a map defined for this area at Emerald Knight's site

	                if (mapExtData[areaid].emeraldid ~= nil) then                       -- Exact match on area id
	                	
				ColourTell("MediumSeaGreen", "", padRight("Emerald Knights" .. " ", 20, " "))
	                	local url = emeraldroot .. mapExtData[areaid].emeraldid
	                	Hyperlink(url, url, "[Emerald Knights Map]", "blue", "", true)
				print("")
	                end
	
	              	-- This checks if there's a map defined for this area at Seeker's site
	
	                if (mapExtData[areaid].seekerid ~= nil) then                       -- Exact match on area id
	                	ColourTell("MediumSeaGreen", "", padRight("Seeker" .. " ", 20, " "))
	                	local url = seekerroot .. mapExtData[areaid].seekerid
	                	Hyperlink(url, url, "[Seeker Map]", "blue", "", true)
	                	print("")
	                end
	
              	        -- This checks if there's a map defined for this area at Chaos' site

       	                if (mapExtData[areaid].chaosid ~= nil) then                       -- Exact match on area id
        	        	ColourTell("MediumSeaGreen", "", padRight("Chaos" .. " ", 20, " "))
	                        local url = chaosroot .. mapExtData[areaid].chaosid
                	        Hyperlink(url, url, "[Chaos Map]", "blue", "", true)
                        	print("")
	                end
			
			-- This checks if there's a map1 defined for the area

       	                if (mapExtData[areaid].map1 ~= nil) then                       -- Exact match on area id
        	        	ColourTell("MediumSeaGreen", "", padRight("Other" .. " ", 20, " "))
	                        local url = mapExtData[areaid].map1
                	        Hyperlink(url, url, "[Other Map]", "blue", "", true)
                        	print("")
	                end
			
			-- This checks if there's a map2 defined for the area

       	                if (mapExtData[areaid].map2 ~= nil) then                       -- Exact match on area id
        	        	ColourTell("MediumSeaGreen", "", padRight("Other" .. " ", 20, " "))
	                        local url = mapExtData[areaid].map2
                	        Hyperlink(url, url, "[Other Map]", "blue", "", true)
                        	print("")
	                end
		print ""
		else
			ColourNote("SteelBlue", "", "Unable to find maps for area name matching: ", "Red", "",  areaid)
			print("")
        	end
        end
	
	function find_area(wildcards)
		for area in pairs(mapExtData) do
			if (string.find(area, wildcards) ~= nil) then
				return area;
			end
			
		end
	end
	
	function list_areas()
		table.sort(mapExtData, sort_func)
		Note(padRight("Area ID", 15, " ") .. "Area Name")
		Note("-------        ---------")
		for area in pairs(mapExtData) do
		Note(padRight(area, 15, " ") .. mapExtData[area].areaname)
		end
	end	

	-- function to toggle visually impaired mode
	function toggle_vi()
		if (GetVariable("ToggleVI") == "1") then
			SetVariable("ToggleVI", "0")
			ColourNote("SteelBlue", "", "Showmap visually impaired mode has been: ", "Red", "", "Disabled")
		else
			SetVariable("ToggleVI", "1")
			ColourNote("SteelBlue", "", "Showmap visually impaired mode has been: ", "Green", "", "Enabled")
		end
		
	end	
	
	function OnPluginInstall ()
		print("")
		ColourNote("SteelBlue", "", "[LOADED] Showmap v" .. showmap_ver .. " by Pwar (", "MediumSeaGreen", "", "showmap help", "SteelBlue", "",")")
		print("")
	end
	
	------ Utils ------
	function padRight(text, length, padChar)
		local padding = length - string.len(text)
		for i = 1, padding do
			text = text .. padChar
		end
		return text
	end

-- This is the solution I chose for dealing with sorting the keys of the table, it is a compressed function that replaces
-- pairs with one that sorts
-- http://lua-users.org/wiki/SortedIteration

_10=pairs function _1(_6)local _2={}for _4 in _10(_6)do table.insert(_2,_4)end table.sort(_2)return _2 end function _3(_6,_5)if _5==nil then _6._7=_1(_6)_4=_6._7[1]return _4,_6[_4]end _4=nil for _8 = 1,table.getn(_6._7)do if _6._7[_8]==_5 then _4=_6._7[_8+1]end end if _4 then return _4,_6[_4]end _6._7=nil return end function _9(_6)return _3,_6,nil end pairs=_9

]]>
</script> 

</muclient>
